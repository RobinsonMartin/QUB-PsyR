<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.258">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>QUB-PsyR - The two-factorial ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/QUBlogoWsmall.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">QUB-PsyR</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-intro" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Intro</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-intro">    
        <li>
    <a class="dropdown-item" href="./intro1.html">
 <span class="dropdown-text">R and RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./intro2.html">
 <span class="dropdown-text">Running Code in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./intro3.html">
 <span class="dropdown-text">Objects and Functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./intro4.html">
 <span class="dropdown-text">Data Frames and Lists</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./intro5.html">
 <span class="dropdown-text">Saving and Loading Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-working-with-r-objects" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Working with R Objects</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-working-with-r-objects">    
        <li>
    <a class="dropdown-item" href="./working1.html">
 <span class="dropdown-text">Binary Operators</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./working2.html">
 <span class="dropdown-text">Functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./working3.html">
 <span class="dropdown-text">Numerical Indexing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./working4.html">
 <span class="dropdown-text">Logical Indexing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./working5.html">
 <span class="dropdown-text">R Packages</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistical-inference" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Statistical Inference</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-statistical-inference">    
        <li>
    <a class="dropdown-item" href="./inference0.html">
 <span class="dropdown-text">A Primer on Statistical Inference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./inference1.html">
 <span class="dropdown-text">The t-test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./inference2.html">
 <span class="dropdown-text">The ChiÂ²-test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./inference3.html">
 <span class="dropdown-text">Correlations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./inference4.html">
 <span class="dropdown-text">One-factorial Analysis of Variance</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./inference5.html">
 <span class="dropdown-text">Two-factorial Analysis of Variance</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The two-factorial ANOVA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The two-factorial analysis of variance (ANOVA) in an extension of the one-factorial ANOVA. It allows us to test how the mean of a continuous variable differs as a function for two categorical variables <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. In a two-factorial ANOVA, we can not only test for the independent effects of the two variables on the outcome, but also a possible interaction of the two variables <span class="math inline">\(A \times B\)</span>. Here, interaction means that the magnitude and/or direction of the effect of one of the variables depends on the level of the second variable.</p>
<p>A two-factorial design requires that the two variables <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are âcrossedâ. That means that each level of the first factor <span class="math inline">\(A\)</span> must be combined with each level of the second second factor <span class="math inline">\(B\)</span>. If <span class="math inline">\(A\)</span> has three levels and <span class="math inline">\(B\)</span> has two levels, our design has a total of 6 cells, and we would refer to it as a <span class="math inline">\(3 \times 2\)</span>-design.</p>
<p>If we ensure, in addition, that all cells of our design have the same sample size, we call our design <strong>orthogonal</strong>. Orthogonality is not required for running a two-factorial ANOVA, but it comes with an advantage: equal sample sizes make the ANOVA robust against violating the assumption of equal variances.</p>
<section id="general-logic-of-the-two-factorial-anova" class="level2">
<h2 class="anchored" data-anchor-id="general-logic-of-the-two-factorial-anova">General logic of the two-factorial ANOVA</h2>
<p>The model underlying the two-factorial ANOVA looks like this:</p>
<p><span class="math display">\[\mu_{jk} = \mu+\alpha_j+\beta_k+\gamma_{jk}\]</span> Here, <span class="math inline">\(\mu_{jk}\)</span> is the true mean or a combination of the <span class="math inline">\(j\)</span>th level of factor <span class="math inline">\(A\)</span> and the <span class="math inline">\(kth\)</span> level of factor <span class="math inline">\(B\)</span>, <span class="math inline">\(\mu\)</span> is the true grand mean (i.e., the population mean across all groups), <span class="math inline">\(\alpha_j\)</span> is the true effect of the <span class="math inline">\(j\)</span>th level of factor <span class="math inline">\(A\)</span>, <span class="math inline">\(\beta_k\)</span> is the true effect of the <span class="math inline">\(k\)</span>th level of factor <span class="math inline">\(B\)</span>, and <span class="math inline">\(\gamma_{jk}\)</span> is the true effect of combining the <span class="math inline">\(j\)</span>th level of <span class="math inline">\(A\)</span> with the <span class="math inline">\(k\)</span>th level of <span class="math inline">\(B\)</span> that goes beyond the independent contributions of the two factors (<span class="math inline">\(\alpha_j\)</span> and <span class="math inline">\(\beta_k\)</span>).</p>
<p>Just as with the one-factorial ANOVA, its two-factorial cousin partitions the variance of the outcome variable <span class="math inline">\(\sigma_x^2\)</span> into signal and noise. The signal is the variance that stems from differences between groups, and the noise is the variance that is due to differences within the groups. Here, too, we can simplify the partition of variances by partitioning the sums of squares instead. As with the one-factorial ANOVA, we can state that:</p>
<p><span class="math display">\[SS_{total} = SS_{between} + SS_{within}\]</span></p>
<p>The difference to the one-factorial ANVOA is that we can now partition the signal (the <span class="math inline">\(SS_{between}\)</span>) even further. Specifically, we can partition the variability between groups into variability that is due to the first factor <span class="math inline">\(A\)</span>, variability that is due to the second factor <span class="math inline">\(B\)</span>, and variability that results from the interaction of the two factors <span class="math inline">\(A \times B\)</span>. We can state this formally as follows:</p>
<p><span class="math display">\[SS_{between} = SS_A + SS_B + SS_{A \times B}\]</span></p>
<p>Letâs have a closer look at the sums of squares using a simplest possible example, namely the <span class="math inline">\(2 \times 2\)</span>-design, in which factor <span class="math inline">\(A\)</span> has <span class="math inline">\(J = 2\)</span> levels, and factor <span class="math inline">\(B\)</span> also has <span class="math inline">\(K=2\)</span> levels. We can think of this design as a squares divided into four parts (see below):</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="inference5_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In each of the four cells of this <span class="math inline">\(2 \times 2\)</span> design, there are <span class="math inline">\(n_{jk}\)</span> many observations of the outcome variable <span class="math inline">\(x\)</span>, where <span class="math inline">\(n_{jk}\)</span> is the sample size in the cell formed by the <span class="math inline">\(j\)</span>th level of <span class="math inline">\(A\)</span> and the <span class="math inline">\(k\)</span>th level of <span class="math inline">\(B\)</span>. We denote individual observations as <span class="math inline">\(x_{ijk}\)</span>, which refers to the <span class="math inline">\(i\)</span>th observation in the cell formed b the <span class="math inline">\(j\)</span>th level of <span class="math inline">\(A\)</span> and the <span class="math inline">\(k\)</span>th level of <span class="math inline">\(B\)</span>.</p>
<p>When we want to partition the sum of squares in a two-factorial design, we first need to compute the total sum of squares. We do so, by collapsing across all cells of our design and summing the squared deviations of all observations from the grand mean <span class="math inline">\(\bar{x}\)</span> (i.e., the mean computed across all observations irrespective of which cell they stem from). We can formalise this as:</p>
<p><span class="math display">\[SS_{total} = \sum_{j=1}^{J} \sum_{k=1}^{K} \sum_{i=1}^{n_{jk}} (x_{ijk}-\bar{x})^2\]</span> The next step is computing <span class="math inline">\(SS_{between}\)</span> by pretending that there is no variance within groups. Computing the <span class="math inline">\(SS_{between}\)</span> works similar to the one-factorial ANOVA. That means, we replace each observation <span class="math inline">\(x_{ijk}\)</span> with the mean of its cell <span class="math inline">\(\bar{x}_{jk}\)</span> before computing the sum of the squared deviations from the grand mean <span class="math inline">\(\bar{x}_{jk}\)</span>.</p>
<p><span class="math display">\[SS_{between} = \sum_{j=1}^{J} \sum_{k=1}^{K} n_{jk} \times (\bar{x}_{jk} - \bar{x})^2\]</span> Computing the <span class="math inline">\(SS_{within}\)</span> is also similar to the one-factorial ANOVA. We pretend that there is no variation between groups by replacing the grand mean <span class="math inline">\(\bar{x}\)</span> with the cell means <span class="math inline">\(\bar{x}_{jk}\)</span> in the formula for the total sum of squares.</p>
<p><span class="math display">\[SS_{within} = \sum_{j=1}^{J} \sum_{k=1}^{K} \sum_{i = 1}^{n_{jk}}  (x_{ijk} - \bar{x}_{jk})\]</span></p>
<p>So far, so good. We have now partitioned <span class="math inline">\(SS_{total}\)</span> into the <span class="math inline">\(SS_{between}\)</span> and the <span class="math inline">\(SS_{within}\)</span>. However, since we have a <span class="math inline">\(2 \times 2\)</span>-design, we are not merely interested in <em>whether</em> there is substantial variation between the groups, but also <em>where</em> this variation originates. Thus, we need to partition the sums of squares further.</p>
<p>We first compute <span class="math inline">\(SS_A\)</span>, that is, the variation that is solely due to differences in factor <span class="math inline">\(A\)</span>. We do so by pretending that a) there is no factor <span class="math inline">\(B\)</span>, and b) there is no variation within cells. The latter is necessary because <span class="math inline">\(SS_A\)</span> is part of <span class="math inline">\(SS_{between}\)</span>. The good thing is that we already know how to do it, namely by replacing individual observations with a mean score. But how do we pretend that there is no factor <span class="math inline">\(B\)</span>? Effectively, we collapse across all levels of <span class="math inline">\(B\)</span> and combine them into one big cell for each level of <span class="math inline">\(A\)</span>. Here is what our <span class="math inline">\(2 \times 2\)</span>-design would look like in our minds now:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="inference5_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We now denote the individual observations as <span class="math inline">\(x_{ij\cdot}\)</span>. The little dot reminds us that there was originally another factor <span class="math inline">\(B\)</span> across which we have now collapsed the cells of our design. To obtain <span class="math inline">\(SS_A\)</span>, we now need to replace all individual observations with their respective cell means respective cell means <span class="math inline">\(\bar{x}_{j\cdot}\)</span> and then compute the sum of their squared deviations from the grand mean <span class="math inline">\(\bar{x}\)</span> .</p>
<p><span class="math display">\[SS_A = \sum_{j=1}^{J} n_{j\cdot}(\bar{x}_{j\cdot}-\bar{x})^2   \]</span> Here, <span class="math inline">\(n_{j\cdot}\)</span> refers to the number of observations for the <span class="math inline">\(j\)</span>th level of factor <span class="math inline">\(A\)</span> (irrespective of the level of factor <span class="math inline">\(B\)</span>).</p>
<p>We can now compute the <span class="math inline">\(SS_B\)</span> in a similar fashion, namely by pretending that a) there is no factor <span class="math inline">\(A\)</span>, and b) there is no variation within cells. Our imagined design now looks like this:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="inference5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We note denote individual observations as <span class="math inline">\(x_{i\cdot k}\)</span> to emphasize that we do not consider which level of <span class="math inline">\(A\)</span> an observation stems from. Accordingly, the cell means are now denoted as <span class="math inline">\(\bar{x}_{\cdot k}\)</span>. The <span class="math inline">\(SS_B\)</span> are formally defined as:</p>
<p><span class="math display">\[SS_B = \sum_{k=1}^{K} n_{\cdot k}(\bar{x}_{\cdot k}-\bar{x})^2   \]</span></p>
<p>Finally, we need to compute the variability that is due to the interaction of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. The simplest way to do so is to subtract the newly computed <span class="math inline">\(SS_A\)</span> and <span class="math inline">\(SS_B\)</span> from <span class="math inline">\(SS_{between}\)</span>:</p>
<p><span class="math inline">\(SS_{A \times B} = SS_{between} - SS_A - SS_B\)</span></p>
<p>If we run a two-factorial ANOVA, we no longer need the <span class="math inline">\(SS_{between}\)</span> because its parts, <span class="math inline">\(SS_A\)</span>, <span class="math inline">\(SS_B\)</span>, and <span class="math inline">\(SS_{a \times B}\)</span> contain all the variation between groups. The next step is to test each component of the between-group variation for statistical significance. The logic is similar to that of the one-factorial ANOVA, that is, we test for significant using an <span class="math inline">\(F\)</span>-statistic.</p>
<p>Since we have three possible sources of between-group variability, we will run three tests: one for the main effect of factor <span class="math inline">\(A\)</span>, one for the main effect of factor <span class="math inline">\(B\)</span>, and one for the interaction effect <span class="math inline">\(a \times B\)</span>. For each of these tests, we need to compute the mean squares of the effect we are interested in and divide it by the <span class="math inline">\(MS_within\)</span>. We can obtain <span class="math inline">\(MS_A\)</span>, <span class="math inline">\(MS_B\)</span>, <span class="math inline">\(MS_{A \times B}\)</span>, and <span class="math inline">\(MS_within\)</span> by dividing the respective sum of squares by its degrees of freedom (see below).</p>
<p><span class="math display">\[MS_A = \frac{SS_A}{J-1}\]</span> <span class="math display">\[MS_B = \frac{SS_B}{K-1}\]</span></p>
<p><span class="math display">\[MS_{A\times B} = \frac{SS_{A\times B}}{(J-1)(K-1)}\]</span> <span class="math display">\[MS_{within} = \frac{SS_{within}}{N-J\times K}\]</span></p>
<section id="the-main-effect-of-factor-a" class="level4">
<h4 class="anchored" data-anchor-id="the-main-effect-of-factor-a">The main effect of factor A</h4>
<p>Letâs first look at the test for the main effect of <span class="math inline">\(A\)</span>. The <span class="math inline">\(F\)</span>-statistic looks as follows:</p>
<p><span class="math display">\[\frac{MS_A}{MS_{wihtin}} \sim F_{J-1;N-J\times K}\]</span> We use it to test the following hypotheses:</p>
<p><span class="math inline">\(H_{0_A}: \alpha_j = 0 \quad \forall j\)</span></p>
<p><span class="math inline">\(H_{1_A}: \lnot H_{0_A}\)</span></p>
<p>Remember that <span class="math inline">\(\alpha_j\)</span> is the true effect of the <span class="math inline">\(j\)</span>th level of <span class="math inline">\(A\)</span>, which means that:</p>
<p><span class="math inline">\(\mu_{j\cdot} = \mu+\alpha_j\)</span></p>
<p>In other words, when we add <span class="math inline">\(\alpha_j\)</span> to the overall population mean <span class="math inline">\(\mu\)</span> (the true value of <span class="math inline">\(\bar{x}\)</span>), we obtain the expectancy of the mean for the <span class="math inline">\(j\)</span>th level of <span class="math inline">\(A\)</span> (collapsed over all levels of <span class="math inline">\(B\)</span>).</p>
</section>
<section id="the-main-effect-of-factor-b" class="level4">
<h4 class="anchored" data-anchor-id="the-main-effect-of-factor-b">The main effect of factor B</h4>
<p>Regarding the main effect of <span class="math inline">\(B\)</span>, this is what the <span class="math inline">\(F\)</span>-statistic look:</p>
<p><span class="math display">\[\frac{MS_B}{MS_{wihtin}} \sim F_{K-1;N-J\times K}\]</span> The corresponding hypotheses are:</p>
<p><span class="math inline">\(H_{0_B}: \beta_k = 0 \quad \forall k\)</span></p>
<p><span class="math inline">\(H_{1_B}: \lnot H_{0_B}\)</span></p>
<p>Again, <span class="math inline">\(\beta_k\)</span> is the true effect of the <span class="math inline">\(k\)</span>th level of B. We can state that:</p>
<p><span class="math inline">\(\mu_{\cdot k} = \mu + \beta_k\)</span></p>
<p>This means that adding <span class="math inline">\(\beta_k\)</span> to the true population mean <span class="math inline">\(\mu\)</span> will result in the expected mean of the <span class="math inline">\(k\)</span>th level of factor <span class="math inline">\(B\)</span> (collapsed across all levels of <span class="math inline">\(A\)</span>).</p>
</section>
<section id="the-interaction-of-a-and-b" class="level4">
<h4 class="anchored" data-anchor-id="the-interaction-of-a-and-b">The interaction of A and B</h4>
<p>The <span class="math inline">\(F\)</span>-statistic for the interaction effect <span class="math inline">\(A \times B\)</span> is defined as follows:</p>
<p><span class="math display">\[\frac{MS_{A \times B}}{MS_{wihtin}} \sim F_{(J-1)(K-1);N-J\times K}\]</span></p>
<p>We use this <span class="math inline">\(F\)</span>-statistic to test the final hypothesis, which is very similar to the main effect hypotheses:</p>
<p><span class="math inline">\(H_{0_{A \times B}}: \gamma_{A \times = 0 \quad \forall j,k}\)</span></p>
<p><span class="math inline">\(H_{1_B}: \lnot H_{0_{A\times B}}\)</span></p>
<p>As mentioned above, <span class="math inline">\(\gamma_{jk}\)</span> is the effect that combining the <span class="math inline">\(j\)</span>th level of <span class="math inline">\(A\)</span> and the <span class="math inline">\(k\)</span>th level of <span class="math inline">\(B\)</span> has on the population mean <span class="math inline">\(\mu\)</span> <strong>beyond</strong> the respective main effects <span class="math inline">\(\alpha_j\)</span> and <span class="math inline">\(\beta_k\)</span>. We define <span class="math inline">\(\gamma_{A \times B}\)</span> such that:</p>
<p><span class="math display">\[\mu_{jk} = \mu + \alpha_j + \beta_k + \gamma_{jk} = 0\]</span></p>
<p>This means that when we look at individual cells of our design instead of collapsing across rows or columns, we can obtain the respective true cell mean <span class="math inline">\(\mu_{jk}\)</span> by taking the true grand mean <span class="math inline">\(\mu\)</span> and adding not only <span class="math inline">\(\alpha_j\)</span> and <span class="math inline">\(\beta_k\)</span> but also <span class="math inline">\(\gamma_{jk}\)</span>.</p>
</section>
</section>
<section id="running-a-two-factorial-anova-in-r" class="level2">
<h2 class="anchored" data-anchor-id="running-a-two-factorial-anova-in-r">Running a two-factorial ANOVA in R</h2>
<p>When we want to run a two-factorial ANOVA in R, we can use the same package and function we used for the one-factorial case. That is, we use the <em>aov_ez</em> function of the package <em>afex</em>. Before we can run the analysis, we first need data from a two-factorial design.</p>
<p>Letâs say, we have data from an experimental <span class="math inline">\(2 \times 2"\)</span>-design in which we manipulated two factors: job <em>demands</em> (low vs.&nbsp;high) and <em>autonomy</em> (low. vs.&nbsp;high). The dependent variable is the experienced level of job <em>stress</em>. Letâs further assume that we have gathered data from 50 participants in each of the four cells of our design and stored it i a data frame called âmy_dfâ. Here is an except of the data.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  ID demands control stress
1  1     low     low    112
2  2     low    high     79
3  3    high     low    134
4  4    high    high     76
5  5     low     low    114
6  6     low    high    129</code></pre>
</div>
</div>
<p>The difference to a one-factorial ANOVA is that we need to feed the <em>aov_ez</em> function a vector containing two variable names as its <em>between</em> argument (in the one-factorial case it was a single character value). Here is what the syntax looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-overflow-wrap code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load library afex</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(afex)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># run a two-factorial ANOVA with demands and control as the </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># independent variables and stress as the dependent variable</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>my_ANOVA <span class="ot">=</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">'ID'</span>, <span class="at">between =</span> <span class="fu">c</span>(<span class="st">'demands'</span>, <span class="st">'control'</span>), </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">dv =</span> <span class="st">'stress'</span>, <span class="at">data =</span> my_df)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># display the results of the ANOVA</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>my_ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running this code will create an ANOVA object called âmy_ANOVAâ in the environment and then display the results of the analysis in the console. Here is what the output looks like:</p>
<div class="alert alert-warning">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: demands, control</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: stress
           Effect     df    MSE         F  ges p.value
1         demands 1, 196 455.82 43.92 *** .183   &lt;.001
2         control 1, 196 455.82 20.02 *** .093   &lt;.001
3 demands:control 1, 196 455.82    4.15 * .021    .043
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<p>As we can see, the output is an ANOVA table. R tells us that the tests are based on type-3 sums of squares and tells us what the outcome variable was in our analysis (stress). The table itself contains three effects: a main effect of demands (the first variable we entered as a between-subjects factor), a main effect of control (the second between-subjects factor), and the interaction of the two variables denoted by âdemands:controlâ (in R, the colon often indicates an interaction effect).</p>
<p>For each effect, R displays the numerator and denominator degrees of freedom, the <span class="math inline">\(MS_within\)</span> (they are necessarily equal for all three effects), the <span class="math inline">\(F\)</span>-value, an estimate of the effect size <span class="math inline">\(\eta^2\)</span>, and the <span class="math inline">\(p\)</span>-value. In our example, all three effects are statistically significant. Statistically speaking, we can now reject all of the Null hypotheses, that is, we would conclude that the level of demands has an effect on stress, that the level of control has an effect on stress, and that there is an interaction of the two variables.</p>
</section>
<section id="disentangling-effects-in-a-two-factorial-anova" class="level2">
<h2 class="anchored" data-anchor-id="disentangling-effects-in-a-two-factorial-anova">Disentangling effects in a two-factorial ANOVA</h2>
<p>Similar to the one-factorial ANOVA, the tests we run in a two-factorial ANOVA are unspecific in the sense that they do not tell us which means differ from one another. However, disentangling effect in two-factorial ANOVAs is non-trivial. Which effects we need to disentangle and how we go about it depends on a) whether there is a significant interaction and b) how many levels our factors have.</p>
<p>Letâs first consider what difference it makes whether there is a significant interaction. In order to do that, we first need to consider what a main effect is in a two-factor ANOVA. Here, we must distinguish between the statistical main effect as returned by the ANOVA and an actual main effect in the psychological sense. <strong>We speak of an actual main effect if the order of the levels of one factor holds across all levels of the other factor.</strong> For example, in a <span class="math inline">\(2 \times 2\)</span>-design, we would speak of a main effect of factor <span class="math inline">\(A\)</span> if the first level of <span class="math inline">\(A\)</span> was associated with higher (or lower) scores than its second level, irrespective of whether we look at the first or the second level of factor <span class="math inline">\(B\)</span>.</p>
<p>Here is the problem: because the statistical main effect of a factor in an ANOVA is computed by collapsing across the levels of the other factor, there are different patterns that produce a significant mean difference but do not satisfy the condition described in the previous paragraph. When can those pattern occur? The answer is: when there is an interaction of the two factors.</p>
<p>What does this mean for us? First for the easy case in which there is no interaction. If the interaction effect is not significant, we cannot accept <span class="math inline">\(H_{1_{A\times B}}\)</span>. That means we retain <span class="math inline">\(H_{0_{A\times B}}\)</span> for now (without believing that it is true because the non-significant finding is uninformative). Retaining <span class="math inline">\(H_{0_{A\times B}}\)</span> implies that if there are any significant main effects in the ANOVA, we can interpret them as is and disentangle them similar to effects in a one-factorial ANOVA.</p>
<p>Now letâs assume that we found a significant interaction effect. This is where things become difficult. Letâs look at a few graphs to understand this issue better. All of the situations below constituent cases where there is an interaction (we can tell this from the lines not running parallel), but where we may also find significant main effects in an interaction.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="inference5_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Letâs first consider the main effects. When a factor has only two levels, the case is clear, because we the difference must be between those two levels.</p>
<p>If we have three or more levels, we need to disentangle the main effect in the same way we disentangled them in a one-factorial case. That means we can run pairwise comparisons or custom contrasts on that factor (thus collapsing across all levels of the other factor) using the <em>emmeans</em> function from the package <em>emmeans</em>.</p>
<p>In our example, the factor âdemandsâ had three levels, so we need to investigate where exactly the mean differences originate. We will go with pairwise comparisons adjusted for multiple testing using Bonferroniâs method. Here is the syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-overflow-wrap code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load library emmeans</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons on the demands factor with Bonferroni correction</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(<span class="at">object =</span> my_ANOVA, <span class="at">specs =</span> <span class="st">'demands'</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">contr =</span> <span class="st">'pairwise'</span>, <span class="at">adjust =</span> <span class="st">'bonferroni'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running the code above will yield the following console output:</p>
<div class="alert alert-warning">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 demands emmean   SE  df lower.CL upper.CL
 low       99.9 2.13 196     95.7      104
 high     119.9 2.13 196    115.7      124

Results are averaged over the levels of: control 
Confidence level used: 0.95 

$contrasts
 contrast   estimate   SE  df t.ratio p.value
 low - high      -20 3.02 196  -6.627  &lt;.0001

Results are averaged over the levels of: control </code></pre>
</div>
</div>
</div>
<p>Similar to the one-factorial case, the output will consist of two tables, with the second of them containing the desired information. In this case, both moderate and high demands lead to higher levels of stress (we can interpret this effect causally because we simulated experimental data), but we cannot say whether stress levels differ between moderate and high demands.</p>
<div class="alert alert-danger">
<p><strong>Note</strong>: when we call the <em>emmeans</em> function on a main effect in an ANOVA design with at least two factors, R will also return a message informing us that the results of our pairwise comparisons may be misleading due to involvement in potential interactions.</p>
<p>What does this mean? It means that we should be cautious when interpreting main effects in an ANOVA that contains interaction effects. The reason is that there can be cases, in which there is a statistically significant main effect, but we would not interpret this effect as such.</p>
<p>In brief, we should only accept a main effect as such if the order of the means remains the same on all levels of the other factor(s). However, since the contrasts analysis of a main effect makes general statements about the relations of the individual factor levels while collapsing across all levels of the other factor(s), we cannot say without further analysis whether this relation holds for all levels of the other factor(s).</p>
</div>
<p>The other effect that needs to be disentangled is the interaction effect. The reason is that there are various patterns that can produce an interaction effect, and we need to identify which one lead to the significant interaction (if the interaction is not significant, there is no need to disentangle the effect).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>